#!/bin/bash

curl -s https://raw.githubusercontent.com/mggnet/testnet/main/signature | bash

sleep 2

echo -e "\e[1m\e[32m1. Updating packages... \e[0m" && sleep 1
# update
sudo apt update && sudo apt upgrade -y

echo -e "\e[1m\e[32m2. Installing dependencies... \e[0m" && sleep 1
# packages
sudo apt install curl build-essential git wget jq make gcc tmux -y

# Get IP
GET_IP=$(curl -s ifconfig.me)
echo "export GET_IP=${GET_IP}" >> $HOME/.bash_profile

echo -e "\e[1m\e[32m1. Download Docker... \e[0m" && sleep 1
# Docker
sudo apt update -y && sudo apt install apt-transport-https ca-certificates curl software-properties-common -y && curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - && sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable" && sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin && sudo apt install docker-compose

echo -e "\e[1m\e[32m1. Setting up... \e[0m" && sleep 1
# Docker image
docker run -d -p 44000:44000 --name tpnode thepowerio/tpnode

echo '=============== SETUP FINISHED ==================='

echo -e "To check node status : \e[1m\e[32mcurl http://$GET_IP:44000/api/node/status | jq\e[0m"
